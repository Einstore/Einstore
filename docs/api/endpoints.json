{
  "components": {
    "parameters": {
      "TeamIdHeader": {
        "description": "Active team context. Required for team-scoped endpoints.",
        "in": "header",
        "name": "x-team-id",
        "required": true,
        "schema": {
          "type": "string"
        }
      }
    },
    "schemas": {
      "ApiKeyCreateResponse": {
        "properties": {
          "apiKey": {
            "$ref": "#/components/schemas/ApiKeySummary"
          },
          "token": {
            "type": "string"
          }
        },
        "type": "object"
      },
      "ApiKeySummary": {
        "properties": {
          "createdAt": {
            "format": "date-time",
            "type": "string"
          },
          "createdBy": {
            "nullable": true,
            "properties": {
              "email": {
                "nullable": true,
                "type": "string"
              },
              "id": {
                "type": "string"
              },
              "name": {
                "nullable": true,
                "type": "string"
              },
              "username": {
                "type": "string"
              }
            },
            "type": "object"
          },
          "expiresAt": {
            "format": "date-time",
            "nullable": true,
            "type": "string"
          },
          "id": {
            "type": "string"
          },
          "lastUsedAt": {
            "format": "date-time",
            "nullable": true,
            "type": "string"
          },
          "name": {
            "type": "string"
          },
          "prefix": {
            "type": "string"
          },
          "revokedAt": {
            "format": "date-time",
            "nullable": true,
            "type": "string"
          }
        },
        "type": "object"
      },
      "App": {
        "properties": {
          "createdAt": {
            "format": "date-time",
            "type": "string"
          },
          "id": {
            "type": "string"
          },
          "identifier": {
            "type": "string"
          },
          "name": {
            "type": "string"
          },
          "updatedAt": {
            "format": "date-time",
            "type": "string"
          }
        },
        "type": "object"
      },
      "AuthLoginResult": {
        "properties": {
          "session": {
            "$ref": "#/components/schemas/AuthSession"
          },
          "userId": {
            "type": "string"
          }
        },
        "type": "object"
      },
      "AuthRegisterResult": {
        "properties": {
          "session": {
            "$ref": "#/components/schemas/AuthSession"
          },
          "userId": {
            "type": "string"
          }
        },
        "type": "object"
      },
      "AuthSession": {
        "properties": {
          "accessToken": {
            "type": "string"
          },
          "expiresIn": {
            "type": "number"
          },
          "refreshToken": {
            "type": "string"
          }
        },
        "type": "object"
      },
      "AuthSessionInfo": {
        "properties": {
          "avatarUrl": {
            "nullable": true,
            "type": "string"
          },
          "email": {
            "nullable": true,
            "type": "string"
          },
          "isSuperUser": {
            "type": "boolean"
          },
          "name": {
            "nullable": true,
            "type": "string"
          },
          "status": {
            "type": "string"
          },
          "userId": {
            "type": "string"
          },
          "username": {
            "type": "string"
          }
        },
        "type": "object"
      },
      "Build": {
        "properties": {
          "buildNumber": {
            "type": "string"
          },
          "displayName": {
            "type": "string"
          },
          "id": {
            "type": "string"
          },
          "sizeBytes": {
            "type": "number"
          },
          "storageKind": {
            "type": "string"
          },
          "storagePath": {
            "type": "string"
          },
          "versionId": {
            "type": "string"
          }
        },
        "type": "object"
      },
      "BuildEventTrackRequest": {
        "additionalProperties": false,
        "properties": {
          "deviceId": {
            "type": "string"
          },
          "metadata": {
            "$ref": "#/components/schemas/BuildEventTrackingMetadata"
          },
          "platform": {
            "enum": [
              "ios",
              "watchos",
              "tvos",
              "visionos",
              "android",
              "wearos",
              "auto"
            ],
            "type": "string"
          },
          "targetId": {
            "type": "string"
          }
        },
        "type": "object"
      },
      "BuildEventTrackingMetadata": {
        "additionalProperties": true,
        "description": "Optional tracking metadata for analytics, errors, distribution, device, and usage context.",
        "example": {
          "analytics": {
            "event": {
              "name": "app_launch",
              "properties": {
                "screen": "home"
              }
            },
            "session": {
              "durationMs": 120000,
              "id": "sess_123",
              "startedAt": "2024-08-01T10:00:00Z"
            }
          },
          "device": {
            "locale": "en-US",
            "model": "iPhone15,3",
            "osVersion": "17.4"
          },
          "distribution": {
            "appVersion": "1.2.3",
            "buildNumber": "45",
            "installSource": "email"
          },
          "services": [
            "analytics",
            "distribution",
            "devices",
            "usage"
          ],
          "usage": {
            "timeZone": "America/Los_Angeles",
            "timestamp": "2024-08-01T10:00:00Z"
          }
        },
        "properties": {
          "analytics": {
            "additionalProperties": true,
            "properties": {
              "event": {
                "properties": {
                  "name": {
                    "type": "string"
                  },
                  "properties": {
                    "additionalProperties": true,
                    "type": "object"
                  }
                },
                "type": "object"
              },
              "session": {
                "properties": {
                  "durationMs": {
                    "type": "integer"
                  },
                  "id": {
                    "type": "string"
                  },
                  "startedAt": {
                    "type": "string"
                  }
                },
                "type": "object"
              },
              "userProperties": {
                "additionalProperties": true,
                "type": "object"
              }
            },
            "type": "object"
          },
          "custom": {
            "additionalProperties": true,
            "type": "object"
          },
          "device": {
            "additionalProperties": true,
            "type": "object"
          },
          "distribution": {
            "additionalProperties": true,
            "type": "object"
          },
          "errors": {
            "additionalProperties": true,
            "properties": {
              "message": {
                "type": "string"
              },
              "properties": {
                "additionalProperties": true,
                "type": "object"
              },
              "stackTrace": {
                "type": "string"
              }
            },
            "type": "object"
          },
          "services": {
            "description": "Enabled tracking sections (analytics, errors, distribution, devices, usage).",
            "items": {
              "type": "string"
            },
            "type": "array"
          },
          "usage": {
            "additionalProperties": true,
            "type": "object"
          }
        },
        "type": "object"
      },
      "Capability": {
        "properties": {
          "id": {
            "type": "string"
          },
          "name": {
            "type": "string"
          },
          "targetId": {
            "type": "string"
          }
        },
        "type": "object"
      },
      "ComplianceArtifact": {
        "properties": {
          "buildId": {
            "type": "string"
          },
          "id": {
            "type": "string"
          },
          "kind": {
            "type": "string"
          },
          "storageKind": {
            "type": "string"
          },
          "storagePath": {
            "type": "string"
          }
        },
        "type": "object"
      },
      "CrashReport": {
        "description": "Draft crash payload (uploaded on next launch).",
        "properties": {
          "anrMarkers": {
            "items": {
              "type": "string"
            },
            "type": "array"
          },
          "appId": {
            "type": "string"
          },
          "binaryHash": {
            "description": "Hash of the app binary/APK for fallback identification",
            "type": "string"
          },
          "breadcrumbs": {
            "items": {
              "type": "object"
            },
            "type": "array"
          },
          "crashAt": {
            "format": "date-time",
            "type": "string"
          },
          "custom": {
            "type": "object"
          },
          "device": {
            "type": "object"
          },
          "environment": {
            "type": "string"
          },
          "exceptionType": {
            "type": "string"
          },
          "featureFlags": {
            "items": {
              "type": "string"
            },
            "type": "array"
          },
          "foreground": {
            "type": "boolean"
          },
          "lastScreen": {
            "type": "string"
          },
          "launchAt": {
            "format": "date-time",
            "type": "string"
          },
          "memoryWarningCount": {
            "type": "integer"
          },
          "networkType": {
            "enum": [
              "wifi",
              "cell",
              "offline",
              "unknown"
            ],
            "type": "string"
          },
          "platform": {
            "enum": [
              "ios",
              "android"
            ],
            "type": "string"
          },
          "signal": {
            "type": "string"
          },
          "signingCertHash": {
            "description": "Hash of signing certificate as additional fallback",
            "type": "string"
          },
          "stackTrace": {
            "type": "string"
          },
          "threads": {
            "items": {
              "type": "object"
            },
            "type": "array"
          },
          "versionCode": {
            "type": "string"
          },
          "versionName": {
            "type": "string"
          }
        },
        "type": "object"
      },
      "FeatureFlag": {
        "properties": {
          "defaultEnabled": {
            "type": "boolean"
          },
          "description": {
            "nullable": true,
            "type": "string"
          },
          "id": {
            "type": "string"
          },
          "key": {
            "type": "string"
          },
          "metadata": {
            "nullable": true,
            "type": "object"
          }
        },
        "type": "object"
      },
      "FeatureFlagOverride": {
        "properties": {
          "enabled": {
            "type": "boolean"
          },
          "flagId": {
            "type": "string"
          },
          "id": {
            "type": "string"
          },
          "metadata": {
            "nullable": true,
            "type": "object"
          },
          "rolloutPercentage": {
            "nullable": true,
            "type": "integer"
          },
          "scope": {
            "type": "string"
          },
          "targetKey": {
            "nullable": true,
            "type": "string"
          }
        },
        "type": "object"
      },
      "Module": {
        "properties": {
          "buildId": {
            "type": "string"
          },
          "id": {
            "type": "string"
          },
          "name": {
            "type": "string"
          },
          "onDemand": {
            "type": "boolean"
          }
        },
        "type": "object"
      },
      "Target": {
        "properties": {
          "buildId": {
            "type": "string"
          },
          "bundleId": {
            "type": "string"
          },
          "id": {
            "type": "string"
          },
          "platform": {
            "type": "string"
          },
          "role": {
            "type": "string"
          }
        },
        "type": "object"
      },
      "Team": {
        "properties": {
          "billingCurrency": {
            "nullable": true,
            "type": "string"
          },
          "billingCycleStartAt": {
            "format": "date-time",
            "type": "string"
          },
          "categoryRequired": {
            "type": "boolean"
          },
          "country": {
            "nullable": true,
            "type": "string"
          },
          "createdAt": {
            "format": "date-time",
            "type": "string"
          },
          "defaultCurrency": {
            "nullable": true,
            "type": "string"
          },
          "defaultExportPreset": {
            "type": "string"
          },
          "id": {
            "type": "string"
          },
          "inboxBase": {
            "type": "string"
          },
          "name": {
            "type": "string"
          },
          "overviewStatsPeriod": {
            "type": "string"
          },
          "planLimit": {
            "type": "integer"
          },
          "planName": {
            "type": "string"
          },
          "slug": {
            "type": "string"
          },
          "storageLimitBytes": {
            "nullable": true,
            "type": "number"
          },
          "timezone": {
            "nullable": true,
            "type": "string"
          },
          "updatedAt": {
            "format": "date-time",
            "type": "string"
          },
          "vatNumberRequired": {
            "type": "boolean"
          },
          "vatRegistered": {
            "type": "boolean"
          }
        },
        "type": "object"
      },
      "TeamStats": {
        "properties": {
          "billingCycleStartAt": {
            "format": "date-time",
            "type": "string"
          },
          "downloadsThisMonth": {
            "properties": {
              "bytes": {
                "type": "integer"
              },
              "eventCount": {
                "type": "integer"
              },
              "from": {
                "format": "date-time",
                "type": "string"
              }
            },
            "required": [
              "from",
              "eventCount",
              "bytes"
            ],
            "type": "object"
          },
          "totalStorageBytes": {
            "type": "integer"
          },
          "uploadsInBillingCycle": {
            "properties": {
              "appCount": {
                "type": "integer"
              },
              "buildCount": {
                "type": "integer"
              },
              "bytes": {
                "type": "integer"
              },
              "from": {
                "format": "date-time",
                "type": "string"
              }
            },
            "required": [
              "from",
              "buildCount",
              "appCount",
              "bytes"
            ],
            "type": "object"
          }
        },
        "required": [
          "billingCycleStartAt",
          "totalStorageBytes",
          "downloadsThisMonth",
          "uploadsInBillingCycle"
        ],
        "type": "object"
      },
      "TeamUser": {
        "properties": {
          "avatarUrl": {
            "nullable": true,
            "type": "string"
          },
          "createdAt": {
            "format": "date-time",
            "type": "string"
          },
          "email": {
            "nullable": true,
            "type": "string"
          },
          "fullName": {
            "nullable": true,
            "type": "string"
          },
          "id": {
            "type": "string"
          },
          "name": {
            "nullable": true,
            "type": "string"
          },
          "role": {
            "type": "string"
          },
          "username": {
            "nullable": true,
            "type": "string"
          }
        },
        "type": "object"
      },
      "TeamWithRole": {
        "properties": {
          "billingCurrency": {
            "nullable": true,
            "type": "string"
          },
          "categoryRequired": {
            "type": "boolean"
          },
          "country": {
            "nullable": true,
            "type": "string"
          },
          "createdAt": {
            "format": "date-time",
            "type": "string"
          },
          "defaultCurrency": {
            "nullable": true,
            "type": "string"
          },
          "defaultExportPreset": {
            "type": "string"
          },
          "id": {
            "type": "string"
          },
          "inboxBase": {
            "type": "string"
          },
          "memberRole": {
            "type": "string"
          },
          "name": {
            "type": "string"
          },
          "overviewStatsPeriod": {
            "type": "string"
          },
          "planLimit": {
            "type": "integer"
          },
          "planName": {
            "type": "string"
          },
          "slug": {
            "type": "string"
          },
          "storageLimitBytes": {
            "nullable": true,
            "type": "number"
          },
          "timezone": {
            "nullable": true,
            "type": "string"
          },
          "updatedAt": {
            "format": "date-time",
            "type": "string"
          },
          "vatNumberRequired": {
            "type": "boolean"
          },
          "vatRegistered": {
            "type": "boolean"
          }
        },
        "type": "object"
      },
      "TrackingEvent": {
        "properties": {
          "appVersion": {
            "nullable": true,
            "type": "string"
          },
          "buildId": {
            "type": "string"
          },
          "buildNumber": {
            "nullable": true,
            "type": "string"
          },
          "createdAt": {
            "type": "string"
          },
          "custom": {
            "nullable": true,
            "type": "object"
          },
          "device": {
            "nullable": true,
            "type": "object"
          },
          "deviceAppVersion": {
            "nullable": true,
            "type": "string"
          },
          "deviceBuildNumber": {
            "nullable": true,
            "type": "string"
          },
          "deviceId": {
            "nullable": true,
            "type": "string"
          },
          "deviceManufacturer": {
            "nullable": true,
            "type": "string"
          },
          "deviceModel": {
            "nullable": true,
            "type": "string"
          },
          "deviceOsVersion": {
            "nullable": true,
            "type": "string"
          },
          "distribution": {
            "nullable": true,
            "type": "object"
          },
          "eventName": {
            "nullable": true,
            "type": "string"
          },
          "eventProperties": {
            "nullable": true,
            "type": "object"
          },
          "id": {
            "type": "string"
          },
          "installSource": {
            "nullable": true,
            "type": "string"
          },
          "locale": {
            "nullable": true,
            "type": "string"
          },
          "message": {
            "nullable": true,
            "type": "string"
          },
          "occurredAt": {
            "type": "string"
          },
          "platform": {
            "enum": [
              "ios",
              "watchos",
              "tvos",
              "visionos",
              "android",
              "wearos",
              "auto"
            ],
            "nullable": true,
            "type": "string"
          },
          "service": {
            "enum": [
              "analytics",
              "errors",
              "distribution",
              "devices",
              "usage"
            ],
            "type": "string"
          },
          "sessionDurationMs": {
            "nullable": true,
            "type": "integer"
          },
          "sessionId": {
            "nullable": true,
            "type": "string"
          },
          "sessionStartedAt": {
            "nullable": true,
            "type": "string"
          },
          "stackTrace": {
            "nullable": true,
            "type": "string"
          },
          "targetId": {
            "nullable": true,
            "type": "string"
          },
          "teamId": {
            "type": "string"
          },
          "timeZone": {
            "nullable": true,
            "type": "string"
          },
          "timeZoneOffsetMinutes": {
            "nullable": true,
            "type": "integer"
          },
          "usage": {
            "nullable": true,
            "type": "object"
          },
          "userId": {
            "nullable": true,
            "type": "string"
          },
          "userProperties": {
            "nullable": true,
            "type": "object"
          }
        },
        "type": "object"
      },
      "UserTeamSetting": {
        "properties": {
          "key": {
            "type": "string"
          },
          "value": {}
        },
        "type": "object"
      },
      "Variant": {
        "properties": {
          "buildId": {
            "type": "string"
          },
          "id": {
            "type": "string"
          },
          "key": {
            "type": "string"
          },
          "kind": {
            "type": "string"
          },
          "value": {
            "type": "string"
          }
        },
        "type": "object"
      },
      "Version": {
        "properties": {
          "appId": {
            "type": "string"
          },
          "id": {
            "type": "string"
          },
          "version": {
            "type": "string"
          }
        },
        "type": "object"
      }
    },
    "securitySchemes": {
      "apiKeyAuth": {
        "in": "header",
        "name": "x-api-key",
        "type": "apiKey"
      },
      "bearerAuth": {
        "bearerFormat": "JWT",
        "scheme": "bearer",
        "type": "http"
      }
    }
  },
  "info": {
    "description": "Refactor API (MVP)",
    "title": "Einstore API",
    "version": "1.0.0"
  },
  "openapi": "3.0.3",
  "paths": {
    "/api-keys": {
      "get": {
        "description": "Team admin/owner only.",
        "parameters": [
          {
            "$ref": "#/components/parameters/TeamIdHeader"
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "properties": {
                    "apiKeys": {
                      "items": {
                        "$ref": "#/components/schemas/ApiKeySummary"
                      },
                      "type": "array"
                    }
                  },
                  "type": "object"
                }
              }
            },
            "description": "List"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "summary": "List API keys"
      },
      "post": {
        "description": "Team admin/owner only. Token returned once.",
        "parameters": [
          {
            "$ref": "#/components/parameters/TeamIdHeader"
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "properties": {
                  "expiresAt": {
                    "format": "date-time",
                    "type": "string"
                  },
                  "name": {
                    "type": "string"
                  }
                },
                "required": [
                  "name"
                ],
                "type": "object"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiKeyCreateResponse"
                }
              }
            },
            "description": "Created"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "summary": "Create API key"
      }
    },
    "/api-keys/{id}": {
      "delete": {
        "description": "Team admin/owner only.",
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "$ref": "#/components/parameters/TeamIdHeader"
          }
        ],
        "responses": {
          "200": {
            "description": "Revoked"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "summary": "Revoke API key"
      }
    },
    "/apps": {
      "get": {
        "parameters": [
          {
            "$ref": "#/components/parameters/TeamIdHeader"
          },
          {
            "in": "query",
            "name": "page",
            "required": false,
            "schema": {
              "type": "integer"
            }
          },
          {
            "in": "query",
            "name": "perPage",
            "required": false,
            "schema": {
              "type": "integer"
            }
          },
          {
            "in": "query",
            "name": "limit",
            "required": false,
            "schema": {
              "type": "integer"
            }
          },
          {
            "in": "query",
            "name": "offset",
            "required": false,
            "schema": {
              "type": "integer"
            }
          },
          {
            "in": "query",
            "name": "platform",
            "required": false,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "summary": "List apps"
      },
      "post": {
        "parameters": [
          {
            "$ref": "#/components/parameters/TeamIdHeader"
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/App"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Created"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "summary": "Create app"
      }
    },
    "/apps/{id}": {
      "get": {
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "$ref": "#/components/parameters/TeamIdHeader"
          }
        ],
        "responses": {
          "200": {
            "description": "App"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "summary": "Get app"
      }
    },
    "/apps/{id}/builds": {
      "delete": {
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "$ref": "#/components/parameters/TeamIdHeader"
          }
        ],
        "responses": {
          "200": {
            "description": "Deleted"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "summary": "Delete app builds"
      }
    },
    "/artifacts": {
      "get": {
        "parameters": [
          {
            "$ref": "#/components/parameters/TeamIdHeader"
          }
        ],
        "responses": {
          "200": {
            "description": "List"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "summary": "List compliance artifacts"
      },
      "post": {
        "parameters": [
          {
            "$ref": "#/components/parameters/TeamIdHeader"
          }
        ],
        "responses": {
          "201": {
            "description": "Created"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "summary": "Create compliance artifact"
      }
    },
    "/auth/login": {
      "post": {
        "description": "Ensures a personal team exists for first-time logins.",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "properties": {
                  "identifier": {
                    "type": "string"
                  },
                  "password": {
                    "type": "string"
                  }
                },
                "required": [
                  "identifier",
                  "password"
                ],
                "type": "object"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AuthLoginResult"
                }
              }
            },
            "description": "Session"
          }
        },
        "summary": "Login"
      }
    },
    "/auth/logout": {
      "post": {
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "properties": {
                  "refreshToken": {
                    "type": "string"
                  }
                },
                "required": [
                  "refreshToken"
                ],
                "type": "object"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Revoked"
          }
        },
        "summary": "Logout"
      }
    },
    "/auth/oauth/exchange": {
      "post": {
        "description": "Creates a session and ensures a personal team exists for first-time logins. The first user is marked as a super user.",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "properties": {
                  "authCode": {
                    "type": "string"
                  }
                },
                "required": [
                  "authCode"
                ],
                "type": "object"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Session"
          }
        },
        "summary": "Exchange OAuth auth code"
      }
    },
    "/auth/oauth/{provider}/callback": {
      "get": {
        "responses": {
          "302": {
            "description": "Redirect"
          }
        },
        "summary": "OAuth callback"
      }
    },
    "/auth/oauth/{provider}/start": {
      "get": {
        "requestBody": {
          "required": false
        },
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "properties": {
                    "authorizeUrl": {
                      "type": "string"
                    }
                  },
                  "type": "object"
                }
              }
            },
            "description": "OAuth start"
          }
        },
        "summary": "Start OAuth login"
      }
    },
    "/auth/password-reset": {
      "post": {
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "properties": {
                  "email": {
                    "type": "string"
                  }
                },
                "required": [
                  "email"
                ],
                "type": "object"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Sent"
          }
        },
        "summary": "Request password reset"
      }
    },
    "/auth/password-reset/confirm": {
      "post": {
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "properties": {
                  "newPassword": {
                    "type": "string"
                  },
                  "token": {
                    "type": "string"
                  }
                },
                "required": [
                  "token",
                  "newPassword"
                ],
                "type": "object"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Reset"
          }
        },
        "summary": "Confirm password reset"
      }
    },
    "/auth/refresh": {
      "post": {
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "properties": {
                  "refreshToken": {
                    "type": "string"
                  }
                },
                "required": [
                  "refreshToken"
                ],
                "type": "object"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Session"
          }
        },
        "summary": "Refresh token"
      }
    },
    "/auth/register": {
      "post": {
        "description": "Creates a personal team if the user has no team membership yet. The first registered user is marked as a super user.",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "properties": {
                  "email": {
                    "type": "string"
                  },
                  "password": {
                    "type": "string"
                  },
                  "username": {
                    "type": "string"
                  }
                },
                "required": [
                  "username",
                  "password"
                ],
                "type": "object"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AuthRegisterResult"
                }
              }
            },
            "description": "Registered"
          }
        },
        "summary": "Register user"
      }
    },
    "/auth/session": {
      "get": {
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AuthSessionInfo"
                }
              }
            },
            "description": "Session"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "summary": "Get session"
      }
    },
    "/badges": {
      "get": {
        "parameters": [
          {
            "$ref": "#/components/parameters/TeamIdHeader"
          },
          {
            "in": "query",
            "name": "page",
            "required": false,
            "schema": {
              "type": "integer"
            }
          },
          {
            "in": "query",
            "name": "perPage",
            "required": false,
            "schema": {
              "type": "integer"
            }
          },
          {
            "in": "query",
            "name": "limit",
            "required": false,
            "schema": {
              "type": "integer"
            }
          },
          {
            "in": "query",
            "name": "offset",
            "required": false,
            "schema": {
              "type": "integer"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Badges"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "summary": "Badge counts"
      }
    },
    "/builds": {
      "get": {
        "parameters": [
          {
            "$ref": "#/components/parameters/TeamIdHeader"
          }
        ],
        "responses": {
          "200": {
            "description": "List"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "summary": "List builds"
      },
      "post": {
        "parameters": [
          {
            "$ref": "#/components/parameters/TeamIdHeader"
          }
        ],
        "responses": {
          "201": {
            "description": "Created"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "summary": "Create build"
      }
    },
    "/builds/{id}": {
      "get": {
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "$ref": "#/components/parameters/TeamIdHeader"
          }
        ],
        "responses": {
          "200": {
            "description": "Build"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "summary": "Get build"
      },
      "delete": {
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "$ref": "#/components/parameters/TeamIdHeader"
          }
        ],
        "responses": {
          "200": {
            "description": "Deleted"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "summary": "Delete build"
      }
    },
    "/builds/events": {
      "get": {
        "parameters": [
          {
            "in": "query",
            "name": "page",
            "schema": {
              "default": 1,
              "type": "integer"
            }
          },
          {
            "in": "query",
            "name": "perPage",
            "schema": {
              "default": 25,
              "type": "integer"
            }
          },
          {
            "in": "query",
            "name": "limit",
            "schema": {
              "type": "integer"
            }
          },
          {
            "in": "query",
            "name": "offset",
            "schema": {
              "type": "integer"
            }
          },
          {
            "in": "query",
            "name": "kind",
            "schema": {
              "enum": [
                "download",
                "install"
              ],
              "type": "string"
            }
          },
          {
            "in": "query",
            "name": "kinds",
            "schema": {
              "type": "string"
            }
          },
          {
            "in": "query",
            "name": "buildId",
            "schema": {
              "type": "string"
            }
          },
          {
            "in": "query",
            "name": "appId",
            "schema": {
              "type": "string"
            }
          },
          {
            "in": "query",
            "name": "userId",
            "schema": {
              "type": "string"
            }
          },
          {
            "$ref": "#/components/parameters/TeamIdHeader"
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "properties": {
                    "items": {
                      "items": {
                        "$ref": "#/components/schemas/BuildEvent"
                      },
                      "type": "array"
                    },
                    "page": {
                      "type": "integer"
                    },
                    "perPage": {
                      "type": "integer"
                    },
                    "total": {
                      "type": "integer"
                    },
                    "totalPages": {
                      "type": "integer"
                    }
                  },
                  "type": "object"
                }
              }
            },
            "description": "List"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "summary": "List team build events"
      }
    },
    "/builds/{id}/downloads": {
      "get": {
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "$ref": "#/components/parameters/TeamIdHeader"
          }
        ],
        "responses": {
          "200": {
            "description": "List"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "summary": "List build downloads"
      },
      "post": {
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "$ref": "#/components/parameters/TeamIdHeader"
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "example": {
                "deviceId": "device-123",
                "metadata": {
                  "analytics": {
                    "event": {
                      "name": "app_launch",
                      "properties": {
                        "screen": "home"
                      }
                    },
                    "session": {
                      "durationMs": 120000,
                      "id": "sess_123",
                      "startedAt": "2024-08-01T10:00:00Z"
                    }
                  },
                  "device": {
                    "locale": "en-US",
                    "model": "iPhone15,3",
                    "osVersion": "17.4"
                  },
                  "distribution": {
                    "appVersion": "1.2.3",
                    "buildNumber": "45",
                    "installSource": "email"
                  },
                  "services": [
                    "analytics",
                    "distribution",
                    "devices",
                    "usage"
                  ],
                  "usage": {
                    "timeZone": "America/Los_Angeles",
                    "timestamp": "2024-08-01T10:00:00Z"
                  }
                },
                "platform": "ios",
                "targetId": "ios-app"
              },
              "schema": {
                "$ref": "#/components/schemas/BuildEventTrackRequest"
              }
            }
          },
          "required": false
        },
        "responses": {
          "201": {
            "description": "Created"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "summary": "Record build download"
      }
    },
    "/builds/{id}/events": {
      "get": {
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "in": "query",
            "name": "page",
            "schema": {
              "default": 1,
              "type": "integer"
            }
          },
          {
            "in": "query",
            "name": "perPage",
            "schema": {
              "default": 25,
              "type": "integer"
            }
          },
          {
            "in": "query",
            "name": "limit",
            "schema": {
              "type": "integer"
            }
          },
          {
            "in": "query",
            "name": "offset",
            "schema": {
              "type": "integer"
            }
          },
          {
            "in": "query",
            "name": "service",
            "schema": {
              "enum": [
                "analytics",
                "errors",
                "distribution",
                "devices",
                "usage",
                "crashes"
              ],
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "properties": {
                    "items": {
                      "items": {
                        "$ref": "#/components/schemas/TrackingEvent"
                      },
                      "type": "array"
                    },
                    "page": {
                      "type": "integer"
                    },
                    "perPage": {
                      "type": "integer"
                    },
                    "total": {
                      "type": "integer"
                    },
                    "totalPages": {
                      "type": "integer"
                    }
                  },
                  "type": "object"
                }
              }
            },
            "description": "List"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "summary": "List tracking events"
      },
      "post": {
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/BuildEventTrackRequest"
              }
            }
          },
          "required": false
        },
        "responses": {
          "201": {
            "content": {
              "application/json": {
                "schema": {
                  "properties": {
                    "items": {
                      "items": {
                        "$ref": "#/components/schemas/TrackingEvent"
                      },
                      "type": "array"
                    }
                  },
                  "type": "object"
                }
              }
            },
            "description": "Created"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "summary": "Record tracking events"
      }
    },
    "/builds/{id}/icons": {
      "get": {
        "description": "Lists extracted icon images for build targets and returns URLs or proxy paths.",
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "$ref": "#/components/parameters/TeamIdHeader"
          }
        ],
        "responses": {
          "200": {
            "description": "Build icons"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "summary": "List build icons"
      }
    },
    "/builds/{id}/icons/{targetId}": {
      "get": {
        "description": "Redirects to the extracted icon image for a target.",
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "in": "path",
            "name": "targetId",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "$ref": "#/components/parameters/TeamIdHeader"
          }
        ],
        "responses": {
          "302": {
            "description": "Redirect to icon image"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "summary": "Get build icon"
      }
    },
    "/builds/{id}/installs": {
      "get": {
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "$ref": "#/components/parameters/TeamIdHeader"
          }
        ],
        "responses": {
          "200": {
            "description": "List"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "summary": "List build installs"
      },
      "post": {
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "$ref": "#/components/parameters/TeamIdHeader"
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "example": {
                "deviceId": "device-123",
                "metadata": {
                  "analytics": {
                    "event": {
                      "name": "app_launch",
                      "properties": {
                        "screen": "home"
                      }
                    },
                    "session": {
                      "durationMs": 120000,
                      "id": "sess_123",
                      "startedAt": "2024-08-01T10:00:00Z"
                    }
                  },
                  "device": {
                    "locale": "en-US",
                    "model": "iPhone15,3",
                    "osVersion": "17.4"
                  },
                  "distribution": {
                    "appVersion": "1.2.3",
                    "buildNumber": "45",
                    "installSource": "email"
                  },
                  "services": [
                    "analytics",
                    "distribution",
                    "devices",
                    "usage"
                  ],
                  "usage": {
                    "timeZone": "America/Los_Angeles",
                    "timestamp": "2024-08-01T10:00:00Z"
                  }
                },
                "platform": "ios",
                "targetId": "ios-app"
              },
              "schema": {
                "$ref": "#/components/schemas/BuildEventTrackRequest"
              }
            }
          },
          "required": false
        },
        "responses": {
          "201": {
            "description": "Created"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "summary": "Record build install"
      }
    },
    "/builds/{id}/ios/download": {
      "get": {
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "in": "query",
            "name": "token",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Download"
          }
        },
        "summary": "Download iOS IPA"
      }
    },
    "/builds/{id}/ios/install-link": {
      "post": {
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "$ref": "#/components/parameters/TeamIdHeader"
          }
        ],
        "responses": {
          "200": {
            "description": "Install link"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "summary": "Create iOS install link"
      }
    },
    "/builds/{id}/ios/installs/track": {
      "post": {
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "in": "query",
            "name": "token",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "example": {
                "deviceId": "device-123",
                "metadata": {
                  "analytics": {
                    "event": {
                      "name": "app_launch",
                      "properties": {
                        "screen": "home"
                      }
                    },
                    "session": {
                      "durationMs": 120000,
                      "id": "sess_123",
                      "startedAt": "2024-08-01T10:00:00Z"
                    }
                  },
                  "device": {
                    "locale": "en-US",
                    "model": "iPhone15,3",
                    "osVersion": "17.4"
                  },
                  "distribution": {
                    "appVersion": "1.2.3",
                    "buildNumber": "45",
                    "installSource": "email"
                  },
                  "services": [
                    "analytics",
                    "distribution",
                    "devices",
                    "usage"
                  ],
                  "usage": {
                    "timeZone": "America/Los_Angeles",
                    "timestamp": "2024-08-01T10:00:00Z"
                  }
                },
                "platform": "ios",
                "targetId": "ios-app"
              },
              "schema": {
                "$ref": "#/components/schemas/BuildEventTrackRequest"
              }
            }
          },
          "required": false
        },
        "responses": {
          "201": {
            "description": "Created"
          }
        },
        "summary": "Track iOS install"
      }
    },
    "/builds/{id}/ios/manifest": {
      "get": {
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "in": "query",
            "name": "token",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Manifest"
          }
        },
        "summary": "Get iOS manifest plist"
      }
    },
    "/builds/{id}/metadata": {
      "get": {
        "description": "Returns build metadata with artifacts grouped by kind plus targets/app/version context.",
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "$ref": "#/components/parameters/TeamIdHeader"
          }
        ],
        "responses": {
          "200": {
            "description": "Build metadata"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "summary": "Get build metadata"
      }
    },
    "/builds/{id}/tags": {
      "get": {
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "$ref": "#/components/parameters/TeamIdHeader"
          }
        ],
        "responses": {
          "200": {
            "description": "Build tags"
          },
          "404": {
            "description": "Not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "summary": "List build tags"
      },
      "put": {
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "$ref": "#/components/parameters/TeamIdHeader"
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "properties": {
                  "tags": {
                    "items": {
                      "type": "string"
                    },
                    "type": "array"
                  }
                },
                "required": [
                  "tags"
                ],
                "type": "object"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Updated build tags"
          },
          "404": {
            "description": "Not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "summary": "Replace build tags"
      }
    },
    "/capabilities": {
      "get": {
        "parameters": [
          {
            "$ref": "#/components/parameters/TeamIdHeader"
          }
        ],
        "responses": {
          "200": {
            "description": "List"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "summary": "List capabilities"
      },
      "post": {
        "parameters": [
          {
            "$ref": "#/components/parameters/TeamIdHeader"
          }
        ],
        "responses": {
          "201": {
            "description": "Created"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "summary": "Create capability"
      }
    },
    "/feature-flags": {
      "get": {
        "description": "Super user only.",
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "items": {
                    "$ref": "#/components/schemas/FeatureFlag"
                  },
                  "type": "array"
                }
              }
            },
            "description": "List"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "summary": "List feature flags"
      },
      "post": {
        "description": "Super user only.",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "properties": {
                  "defaultEnabled": {
                    "type": "boolean"
                  },
                  "description": {
                    "type": "string"
                  },
                  "key": {
                    "type": "string"
                  },
                  "metadata": {
                    "type": "object"
                  }
                },
                "required": [
                  "key"
                ],
                "type": "object"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/FeatureFlag"
                }
              }
            },
            "description": "Created"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "summary": "Create or ensure feature flag"
      }
    },
    "/feature-flags/{key}": {
      "delete": {
        "description": "Super user only.",
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/FeatureFlag"
                }
              }
            },
            "description": "Deleted"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "summary": "Delete feature flag"
      },
      "get": {
        "description": "Super user only.",
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/FeatureFlag"
                }
              }
            },
            "description": "Feature flag"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "summary": "Get feature flag by key"
      },
      "patch": {
        "description": "Super user only.",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "properties": {
                  "defaultEnabled": {
                    "type": "boolean"
                  },
                  "description": {
                    "nullable": true,
                    "type": "string"
                  },
                  "metadata": {
                    "nullable": true,
                    "type": "object"
                  }
                },
                "type": "object"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/FeatureFlag"
                }
              }
            },
            "description": "Updated"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "summary": "Update feature flag"
      }
    },
    "/feature-flags/{key}/evaluate": {
      "get": {
        "description": "Super user only.",
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "properties": {
                    "enabled": {
                      "type": "boolean"
                    },
                    "key": {
                      "type": "string"
                    }
                  },
                  "type": "object"
                }
              }
            },
            "description": "Evaluation result"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "summary": "Evaluate feature flag"
      }
    },
    "/feature-flags/{key}/overrides": {
      "get": {
        "description": "Super user only.",
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "items": {
                    "$ref": "#/components/schemas/FeatureFlagOverride"
                  },
                  "type": "array"
                }
              }
            },
            "description": "List"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "summary": "List feature flag overrides"
      },
      "post": {
        "description": "Super user only.",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "properties": {
                  "enabled": {
                    "type": "boolean"
                  },
                  "metadata": {
                    "type": "object"
                  },
                  "rolloutPercentage": {
                    "nullable": true,
                    "type": "integer"
                  },
                  "scope": {
                    "type": "string"
                  },
                  "targetKey": {
                    "nullable": true,
                    "type": "string"
                  }
                },
                "required": [
                  "scope",
                  "enabled"
                ],
                "type": "object"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/FeatureFlagOverride"
                }
              }
            },
            "description": "Created"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "summary": "Create or update feature flag override"
      }
    },
    "/health": {
      "get": {
        "responses": {
          "200": {
            "description": "OK"
          }
        },
        "summary": "Health check"
      }
    },
    "/info": {
      "get": {
        "responses": {
          "200": {
            "description": "Info"
          }
        },
        "summary": "Service info"
      }
    },
    "/modules": {
      "get": {
        "parameters": [
          {
            "$ref": "#/components/parameters/TeamIdHeader"
          }
        ],
        "responses": {
          "200": {
            "description": "List"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "summary": "List modules"
      },
      "post": {
        "parameters": [
          {
            "$ref": "#/components/parameters/TeamIdHeader"
          }
        ],
        "responses": {
          "201": {
            "description": "Created"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "summary": "Create module"
      }
    },
    "/resolve-install": {
      "post": {
        "description": "For iOS installs, the plist must include a prevalidated HTTPS download URL. The plist itself is not protected, so the IPA URL must be tokenized (local) or pre-signed (S3) and time-limited. Both plist and IPA download URLs require valid HTTPS certificates. For Android AABs, use bundletool with a device spec (ABI, density, language, sdkVersion) to generate device-specific APK sets and enforce the 4 GB compressed APK-set limit.",
        "parameters": [
          {
            "$ref": "#/components/parameters/TeamIdHeader"
          }
        ],
        "responses": {
          "200": {
            "description": "Resolver response"
          }
        },
        "summary": "Resolve install"
      }
    },
    "/search": {
      "get": {
        "parameters": [
          {
            "$ref": "#/components/parameters/TeamIdHeader"
          },
          {
            "in": "query",
            "name": "q",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "in": "query",
            "name": "appId",
            "required": false,
            "schema": {
              "type": "string"
            }
          },
          {
            "in": "query",
            "name": "appPage",
            "required": false,
            "schema": {
              "default": 1,
              "type": "integer"
            }
          },
          {
            "in": "query",
            "name": "appPerPage",
            "required": false,
            "schema": {
              "default": 10,
              "type": "integer"
            }
          },
          {
            "in": "query",
            "name": "buildPage",
            "required": false,
            "schema": {
              "default": 1,
              "type": "integer"
            }
          },
          {
            "in": "query",
            "name": "buildPerPage",
            "required": false,
            "schema": {
              "default": 6,
              "type": "integer"
            }
          },
          {
            "in": "query",
            "name": "appLimit",
            "required": false,
            "schema": {
              "default": 10,
              "type": "integer"
            }
          },
          {
            "in": "query",
            "name": "buildLimit",
            "required": false,
            "schema": {
              "default": 6,
              "type": "integer"
            }
          },
          {
            "in": "query",
            "name": "appOffset",
            "required": false,
            "schema": {
              "type": "integer"
            }
          },
          {
            "in": "query",
            "name": "buildOffset",
            "required": false,
            "schema": {
              "type": "integer"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Search results"
          },
          "400": {
            "description": "Invalid query"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "summary": "Search apps and builds (includes tags)"
      }
    },
    "/settings/storage-limit": {
      "get": {
        "parameters": [],
        "responses": {
          "200": {
            "description": "Default storage limit"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "summary": "Get default storage limit (GB)"
      },
      "put": {
        "parameters": [],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "properties": {
                  "defaultLimitGb": {
                    "type": "number"
                  }
                },
                "required": [
                  "defaultLimitGb"
                ],
                "type": "object"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Updated storage limit"
          },
          "400": {
            "description": "Invalid limit"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "summary": "Update default storage limit (GB)"
      }
    },
    "/settings/tariff-overrides": {
      "get": {
        "parameters": [
          {
            "in": "query",
            "name": "page",
            "required": false,
            "schema": {
              "type": "integer"
            }
          },
          {
            "in": "query",
            "name": "perPage",
            "required": false,
            "schema": {
              "type": "integer"
            }
          },
          {
            "in": "query",
            "name": "limit",
            "required": false,
            "schema": {
              "type": "integer"
            }
          },
          {
            "in": "query",
            "name": "offset",
            "required": false,
            "schema": {
              "type": "integer"
            }
          },
          {
            "in": "query",
            "name": "search",
            "required": false,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Tariff overrides"
          },
          "400": {
            "description": "Invalid query"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "summary": "List tariff overrides"
      }
    },
    "/settings/tariff-overrides/{teamId}": {
      "put": {
        "parameters": [
          {
            "in": "path",
            "name": "teamId",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "properties": {
                  "maxUsers": {
                    "nullable": true,
                    "type": "integer"
                  },
                  "maxApps": {
                    "nullable": true,
                    "type": "integer"
                  },
                  "storageLimitBytes": {
                    "nullable": true,
                    "type": "integer"
                  },
                  "transferLimitBytes": {
                    "nullable": true,
                    "type": "integer"
                  }
                },
                "required": [
                  "maxUsers",
                  "maxApps",
                  "storageLimitBytes",
                  "transferLimitBytes"
                ],
                "type": "object"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Saved tariff overrides"
          },
          "400": {
            "description": "Invalid limits"
          },
          "404": {
            "description": "Team not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "summary": "Update tariff overrides"
      }
    },
    "/storage": {
      "get": {
        "parameters": [
          {
            "$ref": "#/components/parameters/TeamIdHeader"
          }
        ],
        "responses": {
          "200": {
            "description": "Storage config"
          }
        },
        "summary": "Get storage config"
      },
      "post": {
        "parameters": [
          {
            "$ref": "#/components/parameters/TeamIdHeader"
          }
        ],
        "responses": {
          "200": {
            "description": "Storage config"
          }
        },
        "summary": "Set storage config"
      }
    },
    "/tags": {
      "get": {
        "parameters": [
          {
            "$ref": "#/components/parameters/TeamIdHeader"
          },
          {
            "in": "query",
            "name": "appId",
            "required": false,
            "schema": {
              "type": "string"
            }
          },
          {
            "in": "query",
            "name": "page",
            "required": false,
            "schema": {
              "default": 1,
              "type": "integer"
            }
          },
          {
            "in": "query",
            "name": "perPage",
            "required": false,
            "schema": {
              "default": 25,
              "type": "integer"
            }
          },
          {
            "in": "query",
            "name": "limit",
            "required": false,
            "schema": {
              "type": "integer"
            }
          },
          {
            "in": "query",
            "name": "offset",
            "required": false,
            "schema": {
              "type": "integer"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Tags list"
          },
          "400": {
            "description": "Invalid query"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "summary": "List team tags"
      }
    },
    "/targets": {
      "get": {
        "parameters": [
          {
            "$ref": "#/components/parameters/TeamIdHeader"
          }
        ],
        "responses": {
          "200": {
            "description": "List"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "summary": "List targets"
      },
      "post": {
        "parameters": [
          {
            "$ref": "#/components/parameters/TeamIdHeader"
          }
        ],
        "responses": {
          "201": {
            "description": "Created"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "summary": "Create target"
      }
    },
    "/teams": {
      "get": {
        "responses": {
          "200": {
            "description": "List"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "summary": "List teams"
      },
      "post": {
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Created"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "summary": "Create team"
      }
    },
    "/teams/stats": {
      "get": {
        "description": "Storage totals, downloads this month, and uploads in the current billing cycle for the active team.",
        "parameters": [
          {
            "$ref": "#/components/parameters/TeamIdHeader"
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TeamStats"
                }
              }
            },
            "description": "Team stats"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "summary": "Team stats"
      }
    },
    "/teams/{teamId}": {
      "get": {
        "parameters": [
          {
            "in": "path",
            "name": "teamId",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "summary": "Get team"
      },
      "patch": {
        "parameters": [
          {
            "in": "path",
            "name": "teamId",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Updated"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "summary": "Update team"
      }
    },
    "/teams/{teamId}/inbox": {
      "get": {
        "parameters": [
          {
            "in": "path",
            "name": "teamId",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "summary": "Get team inbox address"
      }
    },
    "/teams/{teamId}/select": {
      "post": {
        "parameters": [
          {
            "in": "path",
            "name": "teamId",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "summary": "Select active team"
      }
    },
    "/teams/{teamId}/users": {
      "get": {
        "parameters": [
          {
            "in": "path",
            "name": "teamId",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "summary": "List team users"
      },
      "post": {
        "parameters": [
          {
            "in": "path",
            "name": "teamId",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Created"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "summary": "Add team user"
      }
    },
    "/teams/{teamId}/users/{userId}": {
      "delete": {
        "parameters": [
          {
            "in": "path",
            "name": "teamId",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "in": "path",
            "name": "userId",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Removed"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "summary": "Remove team user"
      },
      "patch": {
        "parameters": [
          {
            "in": "path",
            "name": "teamId",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "in": "path",
            "name": "userId",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Updated"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "summary": "Update team user role"
      }
    },
    "/tracking/events": {
      "post": {
        "parameters": [],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/BuildEventTrackRequest"
              }
            }
          },
          "required": false
        },
        "responses": {
          "201": {
            "content": {
              "application/json": {
                "schema": {
                  "properties": {
                    "items": {
                      "items": {
                        "$ref": "#/components/schemas/TrackingEvent"
                      },
                      "type": "array"
                    }
                  },
                  "type": "object"
                }
              }
            },
            "description": "Created"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "summary": "Record tracking events (build auto-resolved)"
      }
    },
    "/usage/storage/users": {
      "get": {
        "parameters": [
          {
            "$ref": "#/components/parameters/TeamIdHeader"
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "properties": {
                    "users": {
                      "items": {
                        "properties": {
                          "buildCount": {
                            "type": "integer"
                          },
                          "downloadBytes": {
                            "type": "integer"
                          },
                          "downloadCount": {
                            "type": "integer"
                          },
                          "email": {
                            "nullable": true,
                            "type": "string"
                          },
                          "fullName": {
                            "nullable": true,
                            "type": "string"
                          },
                          "totalBytes": {
                            "type": "integer"
                          },
                          "userId": {
                            "type": "string"
                          },
                          "username": {
                            "type": "string"
                          }
                        },
                        "required": [
                          "userId",
                          "username",
                          "email",
                          "fullName",
                          "buildCount",
                          "totalBytes",
                          "downloadCount",
                          "downloadBytes"
                        ],
                        "type": "object"
                      },
                      "type": "array"
                    }
                  },
                  "required": [
                    "users"
                  ],
                  "type": "object"
                }
              }
            },
            "description": "Usage"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "summary": "Storage usage by user"
      }
    },
    "/user-team-settings/{key}": {
      "get": {
        "parameters": [
          {
            "in": "path",
            "name": "key",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "summary": "Get user team setting"
      },
      "put": {
        "parameters": [
          {
            "in": "path",
            "name": "key",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "OK"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "summary": "Upsert user team setting"
      }
    },
    "/variants": {
      "get": {
        "parameters": [
          {
            "$ref": "#/components/parameters/TeamIdHeader"
          }
        ],
        "responses": {
          "200": {
            "description": "List"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "summary": "List variants"
      },
      "post": {
        "parameters": [
          {
            "$ref": "#/components/parameters/TeamIdHeader"
          }
        ],
        "responses": {
          "201": {
            "description": "Created"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "summary": "Create variant"
      }
    },
    "/versions": {
      "get": {
        "parameters": [
          {
            "$ref": "#/components/parameters/TeamIdHeader"
          }
        ],
        "responses": {
          "200": {
            "description": "List"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "summary": "List versions"
      },
      "post": {
        "parameters": [
          {
            "$ref": "#/components/parameters/TeamIdHeader"
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Version"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Created"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "summary": "Create version"
      }
    },
    "/versions/{id}": {
      "get": {
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "$ref": "#/components/parameters/TeamIdHeader"
          }
        ],
        "responses": {
          "200": {
            "description": "Version"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "summary": "Get version"
      }
    },
    "/ws": {
      "get": {
        "parameters": [
          {
            "$ref": "#/components/parameters/TeamIdHeader"
          },
          {
            "description": "Access token for websocket auth (browser fallback when Authorization header cannot be set).",
            "in": "query",
            "name": "accessToken",
            "required": false,
            "schema": {
              "type": "string"
            }
          },
          {
            "description": "Team context for websocket auth (browser fallback when x-team-id header cannot be set).",
            "in": "query",
            "name": "teamId",
            "required": false,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "101": {
            "description": "Switching Protocols"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "summary": "Realtime websocket"
      }
    },
    "/ingest/upload-url": {
      "post": {
        "summary": "Create ingest upload URL",
        "description": "Returns a pre-signed URL for IPA/APK upload. The client must upload to storage and then call /ingest/complete-upload.",
        "parameters": [
          {
            "$ref": "#/components/parameters/TeamIdHeader"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "filename": {
                    "type": "string"
                  },
                  "sizeBytes": {
                    "type": "number"
                  },
                  "contentType": {
                    "type": "string"
                  }
                },
                "required": [
                  "filename",
                  "sizeBytes"
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Pre-signed upload details",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "uploadUrl": {
                      "type": "string"
                    },
                    "key": {
                      "type": "string"
                    },
                    "expiresIn": {
                      "type": "number"
                    },
                    "headers": {
                      "type": "object",
                      "additionalProperties": {
                        "type": "string"
                      }
                    }
                  },
                  "required": [
                    "uploadUrl",
                    "key"
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/ingest/complete-upload": {
      "post": {
        "summary": "Finalize ingest upload",
        "description": "Finalizes a pre-signed upload and queues ingest processing via the ingest function.",
        "parameters": [
          {
            "$ref": "#/components/parameters/TeamIdHeader"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "key": {
                    "type": "string"
                  },
                  "filename": {
                    "type": "string"
                  },
                  "sizeBytes": {
                    "type": "number"
                  }
                },
                "required": [
                  "key"
                ]
              }
            }
          }
        },
        "responses": {
          "202": {
            "description": "Ingest queued",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "enum": [
                        "processing"
                      ]
                    },
                    "jobId": {
                      "type": "string"
                    }
                  },
                  "required": [
                    "status",
                    "jobId"
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/ingest/processing-count": {
      "get": {
        "summary": "Get ingest processing count",
        "description": "Returns the number of queued and processing ingest jobs for the active team.",
        "parameters": [
          {
            "$ref": "#/components/parameters/TeamIdHeader"
          }
        ],
        "responses": {
          "200": {
            "description": "Processing count",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "processingCount": {
                      "type": "number"
                    }
                  },
                  "required": [
                    "processingCount"
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/ingest/jobs/{jobId}/callback": {
      "post": {
        "summary": "Ingest function callback",
        "description": "Internal callback used by the ingest function to finalize ingestion.",
        "parameters": [
          {
            "name": "jobId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "token": {
                    "type": "string"
                  },
                  "result": {
                    "type": "object"
                  },
                  "error": {
                    "type": "string"
                  },
                  "message": {
                    "type": "string"
                  }
                },
                "required": [
                  "token"
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Callback processed",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "enum": [
                        "completed",
                        "failed"
                      ]
                    },
                    "result": {
                      "type": "object"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/feature-flags/public": {
      "post": {
        "summary": "Ensure and evaluate public web feature flags",
        "description": "Public endpoint for web flags.",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "flags": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "key": {
                          "type": "string"
                        },
                        "description": {
                          "type": "string"
                        },
                        "defaultEnabled": {
                          "type": "boolean"
                        },
                        "metadata": {
                          "type": "object"
                        }
                      },
                      "required": [
                        "key"
                      ]
                    }
                  },
                  "scope": {
                    "type": "string"
                  }
                },
                "required": [
                  "flags"
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Flags",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "flags": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "key": {
                            "type": "string"
                          },
                          "enabled": {
                            "type": "boolean"
                          }
                        },
                        "required": [
                          "key",
                          "enabled"
                        ]
                      }
                    }
                  },
                  "required": [
                    "flags"
                  ]
                }
              }
            }
          }
        }
      }
    }
  },
  "servers": [
    {
      "url": "http://localhost:8100"
    }
  ]
}

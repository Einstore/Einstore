{
  "info": {
    "name": "Einstore API Integration",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "Health",
      "request": {
        "method": "GET",
        "url": "{{baseUrl}}/health"
      }
    },
    {
      "name": "Register",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "if (pm.response.code === 201) {",
              "  const json = pm.response.json();",
              "  pm.environment.set('accessToken', json.session.accessToken);",
              "  pm.environment.set('refreshToken', json.session.refreshToken);",
              "}",
              "pm.test('Register response ok', function () {",
              "  pm.expect([200, 201, 400]).to.include(pm.response.code);",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "x-team-id",
            "value": "{{teamId}}"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"username\": \"{{username}}\",\n  \"password\": \"StrongPass123!\",\n  \"email\": \"{{email}}\"\n}"
        },
        "url": "{{baseUrl}}/auth/register"
      }
    },
    {
      "name": "Login",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "const json = pm.response.json();",
              "pm.environment.set('accessToken', json.session.accessToken);",
              "pm.environment.set('refreshToken', json.session.refreshToken);",
              "pm.test('Login ok', function () {",
              "  pm.expect(pm.response.code).to.equal(200);",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "x-team-id",
            "value": "{{teamId}}"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"identifier\": \"{{username}}\",\n  \"password\": \"StrongPass123!\"\n}"
        },
        "url": "{{baseUrl}}/auth/login"
      }
    },
    {
      "name": "Create Team",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "const json = pm.response.json();",
              "pm.environment.set('teamId', json.team.id);",
              "pm.test('Create team ok', function () {",
              "  pm.expect(pm.response.code).to.equal(201);",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "x-team-id",
            "value": "{{teamId}}"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"name\": \"Core Team\"\n}"
        },
        "url": "{{baseUrl}}/teams"
      }
    },
    {
      "name": "List Teams",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "const list = pm.response.json()?.teams || pm.response.json() || [];",
              "if (Array.isArray(list) && list.length) { pm.environment.set('teamId', list[0].id); }",
              "pm.test('List teams ok', function () {",
              "  pm.expect(pm.response.code).to.equal(200);",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "x-team-id",
            "value": "{{teamId}}"
          }
        ],
        "url": "{{baseUrl}}/teams"
      }
    },
    {
      "name": "List API Keys",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "const list = pm.response.json()?.apiKeys || [];",
              "if (Array.isArray(list) && list.length) { pm.environment.set('apiKeyId', list[0].id); }",
              "pm.test('List API keys ok', function () {",
              "  pm.expect(pm.response.code).to.equal(200);",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "x-team-id",
            "value": "{{teamId}}"
          }
        ],
        "url": "{{baseUrl}}/api-keys"
      }
    },
    {
      "name": "Create API Key",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "const json = pm.response.json();",
              "if (json?.apiKey?.id) { pm.environment.set('apiKeyId', json.apiKey.id); }",
              "if (json?.token) { pm.environment.set('apiKeyToken', json.token); }",
              "pm.test('Create API key ok', function () {",
              "  pm.expect(pm.response.code).to.equal(201);",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "x-team-id",
            "value": "{{teamId}}"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"name\": \"CI uploads\"\n}"
        },
        "url": "{{baseUrl}}/api-keys"
      }
    },
    {
      "name": "Get Team",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test('Get team ok', function () {",
              "  pm.expect(pm.response.code).to.equal(200);",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "x-team-id",
            "value": "{{teamId}}"
          }
        ],
        "url": "{{baseUrl}}/teams/{{teamId}}"
      }
    },
    {
      "name": "Select Team",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test('Select team ok', function () {",
              "  pm.expect(pm.response.code).to.equal(200);",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "x-team-id",
            "value": "{{teamId}}"
          }
        ],
        "url": "{{baseUrl}}/teams/{{teamId}}/select"
      }
    },
    {
      "name": "Team Inbox",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test('Team inbox ok', function () {",
              "  pm.expect(pm.response.code).to.equal(200);",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "x-team-id",
            "value": "{{teamId}}"
          }
        ],
        "url": "{{baseUrl}}/teams/{{teamId}}/inbox"
      }
    },
    {
      "name": "List Team Users",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test('List team users ok', function () {",
              "  pm.expect(pm.response.code).to.equal(200);",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "x-team-id",
            "value": "{{teamId}}"
          }
        ],
        "url": "{{baseUrl}}/teams/{{teamId}}/users"
      }
    },
    {
      "name": "Register Secondary User",
      "event": [
        {
          "listen": "prerequest",
          "script": {
            "exec": [
              "if (!pm.environment.get('secondaryEmail')) {",
              "  const now = Date.now();",
              "  pm.environment.set('secondaryUsername', `member_${now}`);",
              "  pm.environment.set('secondaryEmail', `member_${now}@example.com`);",
              "}"
            ],
            "type": "text/javascript"
          }
        },
        {
          "listen": "test",
          "script": {
            "exec": [
              "const json = pm.response.json();",
              "pm.environment.set('secondaryUserId', json.userId);",
              "pm.test('Register secondary ok', function () {",
              "  pm.expect([200, 201, 400]).to.include(pm.response.code);",
              "});",
              "pm.environment.set('accessToken', pm.environment.get('accessToken'));",
              "pm.environment.set('refreshToken', pm.environment.get('refreshToken'));"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"username\": \"{{secondaryUsername}}\",\n  \"password\": \"StrongPass123!\",\n  \"email\": \"{{secondaryEmail}}\"\n}"
        },
        "url": "{{baseUrl}}/auth/register"
      }
    },
    {
      "name": "Add Team User",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test('Add team user ok', function () {",
              "  pm.expect([201, 409]).to.include(pm.response.code);",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "x-team-id",
            "value": "{{teamId}}"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"email\": \"{{secondaryEmail}}\"\n}"
        },
        "url": "{{baseUrl}}/teams/{{teamId}}/users"
      }
    },
    {
      "name": "Update Team User Role",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test('Update team user ok', function () {",
              "  pm.expect([200, 404]).to.include(pm.response.code);",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "PATCH",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "x-team-id",
            "value": "{{teamId}}"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"role\": \"admin\"\n}"
        },
        "url": "{{baseUrl}}/teams/{{teamId}}/users/{{secondaryUserId}}"
      }
    },
    {
      "name": "Remove Team User",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test('Remove team user ok', function () {",
              "  pm.expect([200, 404]).to.include(pm.response.code);",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "DELETE",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "x-team-id",
            "value": "{{teamId}}"
          }
        ],
        "url": "{{baseUrl}}/teams/{{teamId}}/users/{{secondaryUserId}}"
      }
    },
    {
      "name": "Get User Team Setting",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test('Get user team setting ok', function () {",
              "  pm.expect(pm.response.code).to.equal(200);",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "x-team-id",
            "value": "{{teamId}}"
          }
        ],
        "url": "{{baseUrl}}/user-team-settings/theme"
      }
    },
    {
      "name": "Upsert User Team Setting",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test('Upsert user team setting ok', function () {",
              "  pm.expect(pm.response.code).to.equal(200);",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "PUT",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "x-team-id",
            "value": "{{teamId}}"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"value\": {\"theme\": \"dark\"}\n}"
        },
        "url": "{{baseUrl}}/user-team-settings/theme"
      }
    },
    {
      "name": "Auth Session",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "x-team-id",
            "value": "{{teamId}}"
          }
        ],
        "url": {
          "raw": "{{baseUrl}}/auth/session",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "auth",
            "session"
          ]
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Auth session ok', function () {",
              "  pm.expect(pm.response.code).to.equal(200);",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "Auth Refresh",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"refreshToken\": \"{{refreshToken}}\"\n}"
        },
        "url": {
          "raw": "{{baseUrl}}/auth/refresh",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "auth",
            "refresh"
          ]
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "const json = pm.response.json();",
              "if (json.session && json.session.accessToken) {",
              "  pm.environment.set('accessToken', json.session.accessToken);",
              "}",
              "if (json.session && json.session.refreshToken) {",
              "  pm.environment.set('refreshToken', json.session.refreshToken);",
              "}",
              "pm.test('Auth refresh ok', function () {",
              "  pm.expect(pm.response.code).to.equal(200);",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "Create App",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "const json = pm.response.json();",
              "pm.environment.set('appId', json.id);",
              "pm.test('Create app ok', function () {",
              "  pm.expect(pm.response.code).to.equal(201);",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "x-team-id",
            "value": "{{teamId}}"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"name\": \"Sample App\",\n  \"identifier\": \"{{appIdentifier}}\"\n}"
        },
        "url": "{{baseUrl}}/apps"
      }
    },
    {
      "name": "Create Version",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "const json = pm.response.json();",
              "pm.environment.set('versionId', json.id);",
              "pm.test('Create version ok', function () {",
              "  pm.expect(pm.response.code).to.equal(201);",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "x-team-id",
            "value": "{{teamId}}"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"appId\": \"{{appId}}\",\n  \"version\": \"1.0.0\"\n}"
        },
        "url": "{{baseUrl}}/versions"
      }
    },
    {
      "name": "Create Build",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "const json = pm.response.json();",
              "pm.environment.set('buildId', json.id);",
              "pm.test('Create build ok', function () {",
              "  pm.expect(pm.response.code).to.equal(201);",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "x-team-id",
            "value": "{{teamId}}"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"appIdentifier\": \"{{appIdentifier}}\",\n  \"appName\": \"Sample App\",\n  \"version\": \"1.0.0\",\n  \"buildNumber\": \"1\",\n  \"displayName\": \"Sample App\",\n  \"storageKind\": \"local\",\n  \"storagePath\": \"/tmp/sample.ipa\",\n  \"sizeBytes\": 12345\n}"
        },
        "url": "{{baseUrl}}/builds"
      }
    },
    {
      "name": "Create Target",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "const json = pm.response.json();",
              "pm.environment.set('targetId', json.id);",
              "pm.test('Create target ok', function () {",
              "  pm.expect(pm.response.code).to.equal(201);",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "x-team-id",
            "value": "{{teamId}}"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"buildId\": \"{{buildId}}\",\n  \"platform\": \"ios\",\n  \"role\": \"app\",\n  \"bundleId\": \"com.example.sample\"\n}"
        },
        "url": "{{baseUrl}}/targets"
      }
    },
    {
      "name": "Create Variant",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test('Create variant ok', function () {",
              "  pm.expect(pm.response.code).to.equal(201);",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "x-team-id",
            "value": "{{teamId}}"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"buildId\": \"{{buildId}}\",\n  \"kind\": \"device\",\n  \"key\": \"family\",\n  \"value\": \"iphone\"\n}"
        },
        "url": "{{baseUrl}}/variants"
      }
    },
    {
      "name": "Create Module",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test('Create module ok', function () {",
              "  pm.expect(pm.response.code).to.equal(201);",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "x-team-id",
            "value": "{{teamId}}"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"buildId\": \"{{buildId}}\",\n  \"name\": \"base\",\n  \"onDemand\": false\n}"
        },
        "url": "{{baseUrl}}/modules"
      }
    },
    {
      "name": "Create Capability",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test('Create capability ok', function () {",
              "  pm.expect(pm.response.code).to.equal(201);",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "x-team-id",
            "value": "{{teamId}}"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"targetId\": \"{{targetId}}\",\n  \"name\": \"push_notifications\"\n}"
        },
        "url": "{{baseUrl}}/capabilities"
      }
    },
    {
      "name": "Create Artifact",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test('Create artifact ok', function () {",
              "  pm.expect(pm.response.code).to.equal(201);",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "x-team-id",
            "value": "{{teamId}}"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"buildId\": \"{{buildId}}\",\n  \"kind\": \"privacy_manifest\",\n  \"storageKind\": \"local\",\n  \"storagePath\": \"/tmp/privacy.plist\"\n}"
        },
        "url": "{{baseUrl}}/artifacts"
      }
    },
    {
      "name": "Get Apps",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "x-team-id",
            "value": "{{teamId}}"
          }
        ],
        "url": {
          "raw": "{{baseUrl}}/apps?page=1&perPage=25",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "apps"
          ],
          "query": [
            {
              "key": "page",
              "value": "1"
            },
            {
              "key": "perPage",
              "value": "25"
            }
          ]
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Get apps ok', function () {",
              "  pm.expect(pm.response.code).to.equal(200);",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "Get App By Id",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "x-team-id",
            "value": "{{teamId}}"
          }
        ],
        "url": {
          "raw": "{{baseUrl}}/apps/{{appId}}",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "apps",
            "{{appId}}"
          ]
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Get app ok', function () {",
              "  pm.expect(pm.response.code).to.equal(200);",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "Delete App Builds",
      "request": {
        "method": "DELETE",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "x-team-id",
            "value": "{{teamId}}"
          }
        ],
        "url": {
          "raw": "{{baseUrl}}/apps/{{appId}}/builds",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "apps",
            "{{appId}}",
            "builds"
          ]
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Delete app builds ok', function () {",
              "  pm.expect(pm.response.code).to.equal(200);",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "Get Versions",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "x-team-id",
            "value": "{{teamId}}"
          }
        ],
        "url": {
          "raw": "{{baseUrl}}/versions?appId={{appId}}",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "versions"
          ],
          "query": [
            {
              "key": "appId",
              "value": "{{appId}}"
            }
          ]
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Get versions ok', function () {",
              "  pm.expect(pm.response.code).to.equal(200);",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "Get Version By Id",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "x-team-id",
            "value": "{{teamId}}"
          }
        ],
        "url": {
          "raw": "{{baseUrl}}/versions/{{versionId}}",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "versions",
            "{{versionId}}"
          ]
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Get version ok', function () {",
              "  pm.expect(pm.response.code).to.equal(200);",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "Get Builds",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "x-team-id",
            "value": "{{teamId}}"
          }
        ],
        "url": {
          "raw": "{{baseUrl}}/builds?page=1&perPage=25",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "builds"
          ],
          "query": [
            {
              "key": "page",
              "value": "1"
            },
            {
              "key": "perPage",
              "value": "25"
            }
          ]
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Get builds ok', function () {",
              "  pm.expect(pm.response.code).to.equal(200);",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "Get Build By Id",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "x-team-id",
            "value": "{{teamId}}"
          }
        ],
        "url": {
          "raw": "{{baseUrl}}/builds/{{buildId}}",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "builds",
            "{{buildId}}"
          ]
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Get build ok', function () {",
              "  pm.expect(pm.response.code).to.equal(200);",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "Delete Build",
      "request": {
        "method": "DELETE",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "x-team-id",
            "value": "{{teamId}}"
          }
        ],
        "url": {
          "raw": "{{baseUrl}}/builds/{{buildId}}",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "builds",
            "{{buildId}}"
          ]
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Delete build ok', function () {",
              "  pm.expect(pm.response.code).to.equal(200);",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "Get Build Metadata",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "x-team-id",
            "value": "{{teamId}}"
          }
        ],
        "url": {
          "raw": "{{baseUrl}}/builds/{{buildId}}/metadata",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "builds",
            "{{buildId}}",
            "metadata"
          ]
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Get build metadata ok', function () {",
              "  pm.expect(pm.response.code).to.equal(200);",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "Get Build Tags",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "x-team-id",
            "value": "{{teamId}}"
          }
        ],
        "url": {
          "raw": "{{baseUrl}}/builds/{{buildId}}/tags",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "builds",
            "{{buildId}}",
            "tags"
          ]
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Get build tags ok', function () {",
              "  pm.expect(pm.response.code).to.equal(200);",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "Set Build Tags",
      "request": {
        "method": "PUT",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "x-team-id",
            "value": "{{teamId}}"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"tags\": [\"release\"]\n}"
        },
        "url": {
          "raw": "{{baseUrl}}/builds/{{buildId}}/tags",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "builds",
            "{{buildId}}",
            "tags"
          ]
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Set build tags ok', function () {",
              "  pm.expect(pm.response.code).to.equal(200);",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "Get Build Icons",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "x-team-id",
            "value": "{{teamId}}"
          }
        ],
        "url": {
          "raw": "{{baseUrl}}/builds/{{buildId}}/icons",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "builds",
            "{{buildId}}",
            "icons"
          ]
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Get build icons ok', function () {",
              "  pm.expect(pm.response.code).to.equal(200);",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "Get Build Icon",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "x-team-id",
            "value": "{{teamId}}"
          }
        ],
        "url": {
          "raw": "{{baseUrl}}/builds/{{buildId}}/icons/{{targetId}}",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "builds",
            "{{buildId}}",
            "icons",
            "{{targetId}}"
          ]
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Get build icon ok', function () {",
              "  pm.expect([200, 404]).to.include(pm.response.code);",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "Create iOS Install Link",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "x-team-id",
            "value": "{{teamId}}"
          }
        ],
        "url": "{{baseUrl}}/builds/{{buildId}}/ios/install-link"
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Create iOS install link ok', function () {",
              "  pm.expect([200, 400]).to.include(pm.response.code);",
              "});",
              "if (pm.response.code === 200) {",
              "  const json = pm.response.json();",
              "  pm.environment.set('manifestUrl', json.manifestUrl);",
              "  pm.environment.set('installTrackUrl', json.installTrackUrl);",
              "} else {",
              "  const fallback = pm.environment.get('baseUrl');",
              "  pm.environment.set('manifestUrl', `${fallback}/health`);",
              "  pm.environment.set('installTrackUrl', `${fallback}/health`);",
              "}"
            ]
          }
        }
      ]
    },
    {
      "name": "Get iOS Manifest",
      "request": {
        "method": "GET",
        "url": "{{manifestUrl}}"
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Get iOS manifest ok', function () {",
              "  pm.expect([200, 404]).to.include(pm.response.code);",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "Track iOS Install",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"platform\": \"ios\",\n  \"deviceId\": \"device-1\"\n}"
        },
        "url": "{{installTrackUrl}}"
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Track iOS install ok', function () {",
              "  pm.expect([200, 201, 400, 404]).to.include(pm.response.code);",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "Get Targets",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "x-team-id",
            "value": "{{teamId}}"
          }
        ],
        "url": {
          "raw": "{{baseUrl}}/targets?buildId={{buildId}}",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "targets"
          ],
          "query": [
            {
              "key": "buildId",
              "value": "{{buildId}}"
            }
          ]
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Get targets ok', function () {",
              "  pm.expect(pm.response.code).to.equal(200);",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "Get Variants",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "x-team-id",
            "value": "{{teamId}}"
          }
        ],
        "url": {
          "raw": "{{baseUrl}}/variants?buildId={buildId}",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "variants"
          ],
          "query": [
            {
              "key": "buildId",
              "value": "{{buildId}}"
            }
          ]
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Get variants ok', function () {",
              "  pm.expect(pm.response.code).to.equal(200);",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "Get Modules",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "x-team-id",
            "value": "{{teamId}}"
          }
        ],
        "url": {
          "raw": "{{baseUrl}}/modules?buildId={{buildId}}",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "modules"
          ],
          "query": [
            {
              "key": "buildId",
              "value": "{{buildId}}"
            }
          ]
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Get modules ok', function () {",
              "  pm.expect(pm.response.code).to.equal(200);",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "Get Capabilities",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "x-team-id",
            "value": "{{teamId}}"
          }
        ],
        "url": {
          "raw": "{{baseUrl}}/capabilities?targetId={{targetId}}",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "capabilities"
          ],
          "query": [
            {
              "key": "targetId",
              "value": "{{targetId}}"
            }
          ]
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Get capabilities ok', function () {",
              "  pm.expect(pm.response.code).to.equal(200);",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "Get Artifacts",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "x-team-id",
            "value": "{{teamId}}"
          }
        ],
        "url": {
          "raw": "{{baseUrl}}/artifacts?buildId={{buildId}}",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "artifacts"
          ],
          "query": [
            {
              "key": "buildId",
              "value": "{{buildId}}"
            }
          ]
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Get artifacts ok', function () {",
              "  pm.expect(pm.response.code).to.equal(200);",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "Create Feature Flag",
      "description": "Super user only.",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "x-team-id",
            "value": "{{teamId}}"
          }
        ],
        "url": {
          "raw": "{{baseUrl}}/feature-flags",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "feature-flags"
          ]
        },
        "body": {
          "mode": "raw",
          "raw": "{\"key\": \"beta.feature\", \"description\": \"Beta rollout\", \"defaultEnabled\": false}"
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Create feature flag ok', function () {",
              "  pm.expect([200, 201, 403]).to.include(pm.response.code);",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "List Feature Flags",
      "description": "Super user only.",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "x-team-id",
            "value": "{{teamId}}"
          }
        ],
        "url": {
          "raw": "{{baseUrl}}/feature-flags",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "feature-flags"
          ]
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('List feature flags ok', function () {",
              "  pm.expect([200, 403]).to.include(pm.response.code);",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "Get Feature Flag",
      "description": "Super user only.",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "x-team-id",
            "value": "{{teamId}}"
          }
        ],
        "url": {
          "raw": "{{baseUrl}}/feature-flags/{{featureFlagKey}}",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "feature-flags",
            "{{featureFlagKey}}"
          ]
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Get feature flag ok', function () {",
              "  pm.expect([200, 403]).to.include(pm.response.code);",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "Update Feature Flag",
      "description": "Super user only.",
      "request": {
        "method": "PATCH",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "x-team-id",
            "value": "{{teamId}}"
          }
        ],
        "url": {
          "raw": "{{baseUrl}}/feature-flags/{{featureFlagKey}}",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "feature-flags",
            "{{featureFlagKey}}"
          ]
        },
        "body": {
          "mode": "raw",
          "raw": "{\"defaultEnabled\": true}"
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Update feature flag ok', function () {",
              "  pm.expect([200, 403]).to.include(pm.response.code);",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "Delete Feature Flag",
      "description": "Super user only.",
      "request": {
        "method": "DELETE",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "x-team-id",
            "value": "{{teamId}}"
          }
        ],
        "url": {
          "raw": "{{baseUrl}}/feature-flags/{{featureFlagKey}}",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "feature-flags",
            "{{featureFlagKey}}"
          ]
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Delete feature flag ok', function () {",
              "  pm.expect([200, 204, 403]).to.include(pm.response.code);",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "Create Feature Flag Override",
      "description": "Super user only.",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "x-team-id",
            "value": "{{teamId}}"
          }
        ],
        "url": {
          "raw": "{{baseUrl}}/feature-flags/{{featureFlagKey}}/overrides",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "feature-flags",
            "{{featureFlagKey}}",
            "overrides"
          ]
        },
        "body": {
          "mode": "raw",
          "raw": "{\"scope\": \"platform\", \"enabled\": true, \"rolloutPercentage\": 100}"
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Create feature flag override ok', function () {",
              "  pm.expect([200, 201, 403]).to.include(pm.response.code);",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "List Feature Flag Overrides",
      "description": "Super user only.",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "x-team-id",
            "value": "{{teamId}}"
          }
        ],
        "url": {
          "raw": "{{baseUrl}}/feature-flags/{{featureFlagKey}}/overrides",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "feature-flags",
            "{{featureFlagKey}}",
            "overrides"
          ]
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('List feature flag overrides ok', function () {",
              "  pm.expect([200, 403]).to.include(pm.response.code);",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "Evaluate Feature Flag",
      "description": "Super user only.",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "x-team-id",
            "value": "{{teamId}}"
          }
        ],
        "url": {
          "raw": "{{baseUrl}}/feature-flags/{{featureFlagKey}}/evaluate",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "feature-flags",
            "{{featureFlagKey}}",
            "evaluate"
          ]
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Evaluate feature flag ok', function () {",
              "  pm.expect([200, 403]).to.include(pm.response.code);",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "Ensure Web Feature Flags",
      "description": "Public web flags.",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "url": {
          "raw": "{{baseUrl}}/feature-flags/public",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "feature-flags",
            "public"
          ]
        },
        "body": {
          "mode": "raw",
          "raw": "{\"flags\":[{\"key\":\"web.hero\",\"description\":\"Show hero section\",\"defaultEnabled\":true}]}"
        }
      },
      "event": []
    },
    {
      "name": "Info",
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{baseUrl}}/info",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "info"
          ]
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Info ok', function () {",
              "  pm.expect(pm.response.code).to.equal(200);",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "Search",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "x-team-id",
            "value": "{{teamId}}"
          }
        ],
        "url": {
          "raw": "{{baseUrl}}/search?q={{searchQuery}}&buildPerPage=6&appPerPage=6",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "search"
          ],
          "query": [
            {
              "key": "q",
              "value": "{{searchQuery}}"
            },
            {
              "key": "buildPerPage",
              "value": "6"
            },
            {
              "key": "appPerPage",
              "value": "6"
            }
          ]
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Search ok', function () {",
              "  pm.expect([200, 400]).to.include(pm.response.code);",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "List Tags",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "x-team-id",
            "value": "{{teamId}}"
          }
        ],
        "url": {
          "raw": "{{baseUrl}}/tags?page=1&perPage=25",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "tags"
          ],
          "query": [
            {
              "key": "page",
              "value": "1"
            },
            {
              "key": "perPage",
              "value": "25"
            },
            {
              "key": "appId",
              "value": "{{appId}}",
              "disabled": true
            }
          ]
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('List tags ok', function () {",
              "  pm.expect([200, 400]).to.include(pm.response.code);",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "Get Storage",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "x-team-id",
            "value": "{{teamId}}"
          }
        ],
        "url": {
          "raw": "{{baseUrl}}/storage",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "storage"
          ]
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Get storage ok', function () {",
              "  pm.expect(pm.response.code).to.equal(200);",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "Set Storage",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "x-team-id",
            "value": "{{teamId}}"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"kind\": \"local\"\n}"
        },
        "url": {
          "raw": "{{baseUrl}}/storage",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "storage"
          ]
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Set storage ok', function () {",
              "  pm.expect(pm.response.code).to.equal(200);",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "Resolve Install",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test('Resolve ok', function () {",
              "  pm.expect(pm.response.code).to.equal(200);",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "x-team-id",
            "value": "{{teamId}}"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"buildId\": \"{{buildId}}\",\n  \"device\": {\n    \"platform\": \"ios\",\n    \"osVersion\": \"17.0\",\n    \"deviceFamily\": \"iphone\",\n    \"pairedWatch\": false\n  }\n}"
        },
        "url": "{{baseUrl}}/resolve-install"
      }
    },
    {
      "name": "Ingest Upload (APK)",
      "item": [
        {
          "name": "Ingest Upload URL (APK)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"filename\": \"{{apkFilename}}\",\n  \"sizeBytes\": \"{{apkSizeBytes}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/ingest/upload-url?token={{apiKeyToken}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "ingest",
                "upload-url"
              ],
              "query": [
                {
                  "key": "token",
                  "value": "{{apiKeyToken}}"
                }
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('Presigned upload URL returned', function () {",
                  "  pm.expect(pm.response.code).to.equal(200);",
                  "});",
                  "const json = pm.response.json();",
                  "if (json && json.uploadUrl) { pm.environment.set('ingestUploadUrl', json.uploadUrl); }",
                  "if (json && json.key) { pm.environment.set('ingestKey', json.key); }",
                  "if (json && json.headers && json.headers['Content-Type']) {",
                  "  pm.environment.set('ingestUploadContentType', json.headers['Content-Type']);",
                  "} else {",
                  "  pm.environment.unset('ingestUploadContentType');",
                  "}"
                ]
              }
            }
          ]
        },
        {
          "name": "Ingest Upload Binary (APK)",
          "request": {
            "method": "PUT",
            "body": {
              "mode": "file",
              "file": {
                "src": "{{apkPath}}"
              }
            },
            "url": "{{ingestUploadUrl}}"
          },
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "const contentType = pm.environment.get('ingestUploadContentType');",
                  "pm.request.headers.remove('Content-Type');",
                  "if (contentType) {",
                  "  pm.request.headers.add({ key: 'Content-Type', value: contentType });",
                  "}"
                ]
              }
            }
          ]
        },
        {
          "name": "Ingest Complete Upload (APK)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"key\": \"{{ingestKey}}\",\n  \"filename\": \"{{apkFilename}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/ingest/complete-upload?token={{apiKeyToken}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "ingest",
                "complete-upload"
              ],
              "query": [
                {
                  "key": "token",
                  "value": "{{apiKeyToken}}"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "Ingest Upload (IPA)",
      "item": [
        {
          "name": "Ingest Upload URL (IPA)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"filename\": \"{{ipaFilename}}\",\n  \"sizeBytes\": \"{{ipaSizeBytes}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/ingest/upload-url?token={{apiKeyToken}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "ingest",
                "upload-url"
              ],
              "query": [
                {
                  "key": "token",
                  "value": "{{apiKeyToken}}"
                }
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('Presigned upload URL returned', function () {",
                  "  pm.expect(pm.response.code).to.equal(200);",
                  "});",
                  "const json = pm.response.json();",
                  "if (json && json.uploadUrl) { pm.environment.set('ingestUploadUrl', json.uploadUrl); }",
                  "if (json && json.key) { pm.environment.set('ingestKey', json.key); }",
                  "if (json && json.headers && json.headers['Content-Type']) {",
                  "  pm.environment.set('ingestUploadContentType', json.headers['Content-Type']);",
                  "} else {",
                  "  pm.environment.unset('ingestUploadContentType');",
                  "}"
                ]
              }
            }
          ]
        },
        {
          "name": "Ingest Upload Binary (IPA)",
          "request": {
            "method": "PUT",
            "body": {
              "mode": "file",
              "file": {
                "src": "{{ipaPath}}"
              }
            },
            "url": "{{ingestUploadUrl}}"
          },
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "const contentType = pm.environment.get('ingestUploadContentType');",
                  "pm.request.headers.remove('Content-Type');",
                  "if (contentType) {",
                  "  pm.request.headers.add({ key: 'Content-Type', value: contentType });",
                  "}"
                ]
              }
            }
          ]
        },
        {
          "name": "Ingest Complete Upload (IPA)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"key\": \"{{ingestKey}}\",\n  \"filename\": \"{{ipaFilename}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/ingest/complete-upload?token={{apiKeyToken}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "ingest",
                "complete-upload"
              ],
              "query": [
                {
                  "key": "token",
                  "value": "{{apiKeyToken}}"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "Revoke API Key",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test('Revoke API key ok', function () {",
              "  pm.expect([200, 404]).to.include(pm.response.code);",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "DELETE",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "x-team-id",
            "value": "{{teamId}}"
          }
        ],
        "url": "{{baseUrl}}/api-keys/{{apiKeyId}}"
      }
    },
    {
      "name": "Auth Password Reset Request",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"email\": \"{{email}}\"\n}"
        },
        "url": {
          "raw": "{{baseUrl}}/auth/password-reset",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "auth",
            "password-reset"
          ]
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "const json = pm.response.json();",
              "if (json.token) { pm.environment.set('resetToken', json.token); }",
              "pm.test('Password reset request ok', function () {",
              "  pm.expect(pm.response.code).to.equal(200);",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "Auth Password Reset Confirm",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"token\": \"{{resetToken}}\",\n  \"newPassword\": \"newpassword123\"\n}"
        },
        "url": {
          "raw": "{{baseUrl}}/auth/password-reset/confirm",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "auth",
            "password-reset",
            "confirm"
          ]
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Password reset confirm ok', function () {",
              "  pm.expect(pm.response.code).to.equal(200);",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "Auth OAuth Start (Google)",
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{baseUrl}}/auth/oauth/google/start?redirectUri={{baseUrl}}/auth/oauth/google/callback&successRedirect={{adminBaseUrl}}/login&failureRedirect={{adminBaseUrl}}/login",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "auth",
            "oauth",
            "google",
            "start"
          ],
          "query": [
            {
              "key": "redirectUri",
              "value": "{{baseUrl}}/auth/oauth/google/callback"
            },
            {
              "key": "successRedirect",
              "value": "{{adminBaseUrl}}/login"
            },
            {
              "key": "failureRedirect",
              "value": "{{adminBaseUrl}}/login"
            }
          ]
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('OAuth start ok', function () {",
              "  pm.expect([200, 400]).to.include(pm.response.code);",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "Auth OAuth Callback (Google)",
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{baseUrl}}/auth/oauth/google/callback?state={{oauthState}}&code={{oauthCode}}",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "auth",
            "oauth",
            "google",
            "callback"
          ],
          "query": [
            {
              "key": "state",
              "value": "{{oauthState}}"
            },
            {
              "key": "code",
              "value": "{{oauthCode}}"
            }
          ]
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('OAuth callback redirect', function () {",
              "  pm.expect([302, 303, 400]).to.include(pm.response.code);",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "Auth OAuth Exchange",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"authCode\": \"{{authCode}}\"\n}"
        },
        "url": {
          "raw": "{{baseUrl}}/auth/oauth/exchange",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "auth",
            "oauth",
            "exchange"
          ]
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('OAuth exchange ok', function () {",
              "  pm.expect([200, 400]).to.include(pm.response.code);",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "Auth Logout",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"refreshToken\": \"{{refreshToken}}\"\n}"
        },
        "url": {
          "raw": "{{baseUrl}}/auth/logout",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "auth",
            "logout"
          ]
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Auth logout ok', function () {",
              "  pm.expect(pm.response.code).to.equal(200);",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "Team Isolation",
      "item": [
        {
          "name": "Login Secondary User",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "const json = pm.response.json();",
                  "pm.environment.set('secondaryAccessToken', json.session.accessToken);",
                  "pm.environment.set('secondaryRefreshToken', json.session.refreshToken);",
                  "pm.test('Secondary login ok', function () {",
                  "  pm.expect(pm.response.code).to.equal(200);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{secondaryAccessToken}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"identifier\": \"{{secondaryUsername}}\",\n  \"password\": \"StrongPass123!\"\n}"
            },
            "url": "{{baseUrl}}/auth/login"
          }
        },
        {
          "name": "List Teams (Secondary)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "const list = pm.response.json()?.teams || pm.response.json() || [];",
                  "if (Array.isArray(list) && list.length) { pm.environment.set('secondaryTeamId', list[0].id); }",
                  "pm.test('Secondary teams ok', function () {",
                  "  pm.expect(pm.response.code).to.equal(200);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{secondaryAccessToken}}"
              },
              {
                "key": "x-team-id",
                "value": "{{secondaryTeamId}}"
              }
            ],
            "url": "{{baseUrl}}/teams"
          }
        },
        {
          "name": "Cross-team Apps Forbidden",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Cross-team access forbidden', function () {",
                  "  pm.expect([401, 403, 404]).to.include(pm.response.code);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{secondaryAccessToken}}"
              },
              {
                "key": "x-team-id",
                "value": "{{teamId}}"
              }
            ],
            "url": "{{baseUrl}}/apps"
          }
        }
      ]
    },
    {
      "name": "Get Badges",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "x-team-id",
            "value": "{{teamId}}"
          }
        ],
        "url": {
          "raw": "{{baseUrl}}/badges",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "badges"
          ]
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Badges ok', function () {",
              "  pm.expect(pm.response.code).to.equal(200);",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "Storage Usage Users",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "x-team-id",
            "value": "{{teamId}}"
          }
        ],
        "url": {
          "raw": "{{baseUrl}}/usage/storage/users",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "usage",
            "storage",
            "users"
          ]
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Storage usage ok', function () {",
              "  pm.expect(pm.response.code).to.equal(200);",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "Record Build Download",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "x-team-id",
            "value": "{{teamId}}"
          },
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "url": {
          "raw": "{{baseUrl}}/builds/{{buildId}}/downloads",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "builds",
            "{{buildId}}",
            "downloads"
          ]
        },
        "body": {
          "mode": "raw",
          "raw": "{\n  \"platform\": \"ios\",\n  \"deviceId\": \"device-1\"\n}"
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Download recorded', function () {",
              "  pm.expect(pm.response.code).to.equal(201);",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "List Build Downloads",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "x-team-id",
            "value": "{{teamId}}"
          }
        ],
        "url": {
          "raw": "{{baseUrl}}/builds/{{buildId}}/downloads",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "builds",
            "{{buildId}}",
            "downloads"
          ]
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Downloads list ok', function () {",
              "  pm.expect(pm.response.code).to.equal(200);",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "List Recent Build Events",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "x-team-id",
            "value": "{{teamId}}"
          }
        ],
        "url": {
          "raw": "{{baseUrl}}/builds/events?perPage=5&kinds=download,install",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "builds",
            "events"
          ],
          "query": [
            {
              "key": "perPage",
              "value": "5"
            },
            {
              "key": "kinds",
              "value": "download,install"
            },
            {
              "key": "appId",
              "value": "{{appId}}",
              "disabled": true
            },
            {
              "key": "userId",
              "value": "{{userId}}",
              "disabled": true
            }
          ]
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Recent events ok', function () {",
              "  pm.expect(pm.response.code).to.equal(200);",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "Record Build Install",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "x-team-id",
            "value": "{{teamId}}"
          },
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "url": {
          "raw": "{{baseUrl}}/builds/{{buildId}}/installs",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "builds",
            "{{buildId}}",
            "installs"
          ]
        },
        "body": {
          "mode": "raw",
          "raw": "{\n  \"platform\": \"android\",\n  \"deviceId\": \"device-2\"\n}"
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Install recorded', function () {",
              "  pm.expect(pm.response.code).to.equal(201);",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "List Build Installs",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "x-team-id",
            "value": "{{teamId}}"
          }
        ],
        "url": {
          "raw": "{{baseUrl}}/builds/{{buildId}}/installs",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "builds",
            "{{buildId}}",
            "installs"
          ]
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Installs list ok', function () {",
              "  pm.expect(pm.response.code).to.equal(200);",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "List Tracking Events",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          }
        ],
        "url": {
          "raw": "{{baseUrl}}/builds/{{buildId}}/events?service=crashes&page=1&perPage=10",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "builds",
            "{{buildId}}",
            "events"
          ],
          "query": [
            {
              "key": "service",
              "value": "crashes"
            },
            {
              "key": "page",
              "value": "1"
            },
            {
              "key": "perPage",
              "value": "10"
            }
          ]
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('status 200', function () { pm.response.to.have.status(200); });",
              "const body = pm.response.json();",
              "pm.test('crash items ok', function () { pm.expect(Array.isArray(body.items)).to.equal(true); if (body.items.length) { pm.expect(body.items[0].service).to.eql('crashes'); } });"
            ]
          }
        }
      ]
    },
    {
      "name": "Team Stats",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "x-team-id",
            "value": "{{teamId}}"
          }
        ],
        "url": {
          "raw": "{{baseUrl}}/teams/stats",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "teams",
            "stats"
          ]
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Team stats ok', function () {",
              "  pm.expect(pm.response.code).to.equal(200);",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "Record Tracking Events (auto)",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "url": {
          "raw": "{{baseUrl}}/tracking/events",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "tracking",
            "events"
          ]
        },
        "body": {
          "mode": "raw",
          "raw": "{\n  \"platform\": \"ios\",\n  \"targetId\": \"com.example.app\",\n  \"deviceId\": \"device-123\",\n  \"metadata\": {\n    \"services\": [\"analytics\", \"errors\", \"usage\"],\n    \"analytics\": {\n      \"event\": { \"name\": \"app_launch\", \"properties\": { \"screen\": \"home\" } },\n      \"session\": { \"id\": \"sess-1\", \"startedAt\": \"2024-01-01T00:00:00Z\", \"durationMs\": 120000 }\n    },\n    \"errors\": { \"message\": \"Handled error\", \"stackTrace\": \"Error: ...\" },\n    \"usage\": { \"timestamp\": \"2024-01-01T00:00:00Z\", \"timeZone\": \"UTC\", \"locale\": \"en-US\" }\n  }\n}"
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (pm.response.code === 201) { pm.test('status 201', function () { pm.response.to.have.status(201); }); } else { pm.test('skipped auto resolution (expected 404/400 if target missing)', function () { pm.expect([400,404]).to.include(pm.response.code); }); }"
            ]
          }
        }
      ]
    },
    {
      "name": "Record Tracking Events (by build id)",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "url": {
          "raw": "{{baseUrl}}/builds/{{buildId}}/events",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "builds",
            "{{buildId}}",
            "events"
          ]
        },
        "body": {
          "mode": "raw",
          "raw": "{\n  \"platform\": \"ios\",\n  \"deviceId\": \"device-test\",\n  \"metadata\": {\n    \"services\": [\n      \"analytics\",\n      \"errors\",\n      \"distribution\",\n      \"devices\",\n      \"usage\",\n      \"crashes\"\n    ],\n    \"analytics\": {\n      \"event\": {\n        \"name\": \"app_launch_test\",\n        \"properties\": {\n          \"screen\": \"home\"\n        }\n      },\n      \"userProperties\": {\n        \"plan\": \"pro\"\n      },\n      \"session\": {\n        \"id\": \"sess-postman\",\n        \"startedAt\": \"2024-01-01T00:00:00.000Z\",\n        \"durationMs\": 5000\n      }\n    },\n    \"errors\": {\n      \"message\": \"handled\",\n      \"stackTrace\": \"stack\"\n    },\n    \"distribution\": {\n      \"installSource\": \"postman\",\n      \"appVersion\": \"1.0.0\",\n      \"buildNumber\": \"1\"\n    },\n    \"device\": {\n      \"model\": \"Postman Simulator\",\n      \"manufacturer\": \"Einstore\",\n      \"osVersion\": \"1.0\",\n      \"locale\": \"en-US\",\n      \"appVersion\": \"1.0.0\",\n      \"buildNumber\": \"1\"\n    },\n    \"usage\": {\n      \"timestamp\": \"2024-01-01T00:00:00.000Z\",\n      \"timeZone\": \"UTC\",\n      \"sessionId\": \"sess-postman\",\n      \"sessionDurationMs\": 5000\n    },\n    \"crash\": {\n      \"exceptionType\": \"SIGABRT\",\n      \"stackTrace\": \"crash stack\",\n      \"occurredAt\": \"2024-01-02T00:00:00.000Z\",\n      \"appVersion\": \"1.0.0\",\n      \"buildNumber\": \"1\",\n      \"binaryHash\": \"abc123\"\n    }\n  }\n}"
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('status 201', function () { pm.response.to.have.status(201); });",
              "const body = pm.response.json();",
              "pm.test('creates one per service', function () { pm.expect(body.items.length).to.eql(6); });",
              "pm.test('services include crashes', function () { pm.expect(body.items.map(i=>i.service)).to.include('crashes'); });",
              "pm.test('build id matches env', function () { pm.expect(body.items.every(i=>i.buildId===pm.environment.get('buildId'))).to.be.true; });"
            ]
          }
        }
      ]
    }
  ],
  "event": [
    {
      "listen": "prerequest",
      "script": {
        "type": "text/javascript",
        "exec": [
          "if (!pm.environment.get('username')) {",
          "  const now = Date.now();",
          "  pm.environment.set('username', `tester_${now}`);",
          "  pm.environment.set('email', `tester_${now}@example.com`);",
          "  pm.environment.set('appIdentifier', `com.example.sample.${now}`);",
          "}"
        ]
      }
    }
  ]
}

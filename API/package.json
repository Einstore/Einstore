{
  "name": "einstore-api",
  "version": "1.0.0",
  "private": true,
  "type": "module",
  "scripts": {
    "dev": "npm run private:prepare && tsx watch src/index.ts",
    "build": "npm run private:prepare && tsc -p tsconfig.json",
    "do:build": "if [ -n \"$BILLING_DEPLOY_KEY\" ]; then mkdir -p ~/.ssh && echo \"$BILLING_DEPLOY_KEY\" > ~/.ssh/id_rsa && chmod 600 ~/.ssh/id_rsa && ssh-keyscan github.com >> ~/.ssh/known_hosts && mkdir -p ../Private && rm -rf ../Private/billing && git clone git@github.com:Einstore/Billing.git ../Private/billing; fi && npm --prefix ../Libraries/rafiki-auth install && npm --prefix ../Libraries/rafiki-auth run build && rm -rf node_modules/@unlikeother/auth/dist && mkdir -p node_modules/@unlikeother/auth/dist && cp -R ../Libraries/rafiki-auth/dist/* node_modules/@unlikeother/auth/dist/ && npm --prefix ../Libraries/teams install && npm --prefix ../Libraries/teams run build && rm -rf node_modules/@rafiki270/teams/dist && mkdir -p node_modules/@rafiki270/teams/dist && cp -R ../Libraries/teams/dist/* node_modules/@rafiki270/teams/dist/ && npm run prisma:generate && npm run build",
    "start": "node dist/index.js",
    "test:unit": "node scripts/run-unit-tests.mjs",
    "test:integration": "newman run ../postman_collection.json -e ../tests/newman/local.postman_environment.json --folder \"Upload Ingest (APK)\" --folder \"iOS Ingest\" --folder \"Store Upload (token query)\"",
    "postinstall": "npm run prisma:generate",
    "private:prepare": "node ./scripts/prepare-private.mjs",
    "prisma:generate": "npm run private:prepare && prisma generate --schema prisma/generated/schema.prisma",
    "prisma:migrate": "npm run private:prepare && prisma migrate dev --schema prisma/generated/schema.prisma",
    "prisma:deploy": "npm run private:prepare && prisma migrate deploy --schema prisma/generated/schema.prisma",
    "prisma:ensure-schema": "npm run private:prepare && if [ \"$ENABLE_SCHEMA_CREATE\" = \"true\" ]; then echo \"CREATE SCHEMA IF NOT EXISTS einstore;\" | prisma db execute --stdin --schema prisma/generated/schema.prisma; else echo \"Skipping schema creation (ENABLE_SCHEMA_CREATE not set)\"; fi"
  },
  "dependencies": {
    "@aws-sdk/client-s3": "^3.966.0",
    "@aws-sdk/s3-request-presigner": "^3.966.0",
    "@devicefarmer/adbkit-apkreader": "^3.2.4",
    "@fastify/cors": "^8.5.0",
    "@fastify/multipart": "^8.3.0",
    "@fastify/websocket": "^8.3.1",
    "@prisma/client": "^6.16.1",
    "@rafiki270/api-keys": "git+https://github.com/rafiki270/api-keys.git#fb406cd",
    "@rafiki270/feature-flags": "git+https://github.com/rafiki270/FeatureFlags.git#65d22e5",
    "@rafiki270/teams": "git+https://github.com/rafiki270/teams.git#935a199",
    "@unlikeother/auth": "git+https://github.com/rafiki270/auth.git#37724a16ae7835fa24533f1b03df61a0b6e38af1",
    "apk-parser3": "^0.1.7",
    "bplist-parser": "^0.3.2",
    "dotenv": "^16.4.5",
    "fastify": "^4.29.0",
    "plist": "^3.1.0",
    "sharp": "^0.34.5",
    "yauzl": "^2.10.0",
    "zod": "^3.23.8"
  },
  "devDependencies": {
    "@types/node": "^22.10.1",
    "@types/plist": "^3.0.5",
    "@types/yauzl": "^2.10.3",
    "newman": "^6.2.1",
    "prisma": "^6.16.1",
    "tsx": "^4.19.2",
    "typescript": "^5.7.2",
    "vitest": "^1.6.0"
  }
}
